package jetbrains.mps.vclang.behavior;

/*Generated by MPS */

import com.jetbrains.jetpad.vclang.term.expr.visitor.AbstractExpressionVisitor;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.LinkedListSequence;
import java.util.LinkedList;
import java.util.Deque;
import jetbrains.mps.internal.collections.runtime.DequeSequence;
import com.jetbrains.jetpad.vclang.term.Abstract;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import com.jetbrains.jetpad.vclang.term.Prelude;
import com.jetbrains.jetpad.vclang.term.expr.Expression;
import com.jetbrains.jetpad.vclang.term.expr.ExpressionFactory;
import com.jetbrains.jetpad.vclang.term.expr.visitor.NormalizeVisitor;
import jetbrains.mps.vclang.prelude.PreludeInitializer;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.typesystem.runtime.HUtil;
import com.jetbrains.jetpad.vclang.term.definition.Definition;
import com.jetbrains.jetpad.vclang.module.DefinitionPair;
import com.jetbrains.jetpad.vclang.term.definition.Universe;
import jetbrains.mps.internal.collections.runtime.ISelector;
import jetbrains.mps.internal.collections.runtime.IWhereFilter;
import java.util.Iterator;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SEnumOperations;
import com.jetbrains.jetpad.vclang.term.pattern.NamePattern;
import com.jetbrains.jetpad.vclang.term.pattern.ConstructorPattern;
import org.jetbrains.mps.openapi.persistence.PersistenceFacade;
import jetbrains.mps.smodel.SModelUtil_new;
import org.jetbrains.mps.openapi.model.SNodeAccessUtil;

public class BuildModelVisitor implements AbstractExpressionVisitor<Void, SNode> {
  public BuildOptions option = BuildOptions.DEFAULT;
  public List<SNode> indices = LinkedListSequence.fromLinkedListNew(new LinkedList<SNode>());
  public Deque<List<SNode>> indexStack = DequeSequence.fromDequeNew(new LinkedList<List<SNode>>());

  public SNode visitApp(Abstract.AppExpression expression, Void context) {
    List<Abstract.ArgumentExpression> args = ListSequence.fromList(new ArrayList<Abstract.ArgumentExpression>());
    Abstract.Expression expr = Abstract.getFunction(expression, args);

    if (expr instanceof Abstract.DefCallExpression && ((Abstract.DefCallExpression) expr).getDefinitionPair().definition == Prelude.PATH) {
      if (ListSequence.fromList(args).count() == 3 && ListSequence.fromList(args).getElement(0).getExpression() instanceof Expression && ExpressionFactory.Apps(((Expression) ListSequence.fromList(args).getElement(0).getExpression()).liftIndex(0, 1), ExpressionFactory.Index(0)).normalize(NormalizeVisitor.Mode.NF).liftIndex(0, -1) != null) {
        return _quotation_createNode_b65po9_a0a0a3a4(ListSequence.fromList(args).getElement(1).getExpression().accept(this, context), ListSequence.fromList(args).getElement(2).getExpression().accept(this, context), PreludeInitializer.path_infix);
      }
    }

    Abstract.ArgumentExpression e = expression.getArgument();
    SNode lhs = expression.getFunction().accept(this, context);
    SNode rhs = e.getExpression().accept(this, context);
    boolean isHidden;
    if (option == BuildOptions.VERBOSE) {
      isHidden = false;
    } else if (option == BuildOptions.COMPACT) {
      isHidden = true;
    } else {
      isHidden = e.isHidden();
    }

    if (SNodeOperations.isInstanceOf(lhs, MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a64eL, "jetbrains.mps.vclang.structure.ApplicationExpression")) && SNodeOperations.isInstanceOf(SLinkOperations.getTarget(SNodeOperations.cast(lhs, MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a64eL, "jetbrains.mps.vclang.structure.ApplicationExpression")), MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b68L, "leftArg")), MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x40feb6e2a72ce3afL, "jetbrains.mps.vclang.structure.DefExpression")) && (boolean) Definition__BehaviorDescriptor.isInfix_id6oOmj_oc_dk.invoke(SLinkOperations.getTarget(SNodeOperations.cast(SLinkOperations.getTarget(SNodeOperations.cast(lhs, MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a64eL, "jetbrains.mps.vclang.structure.ApplicationExpression")), MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b68L, "leftArg")), MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x40feb6e2a72ce3afL, "jetbrains.mps.vclang.structure.DefExpression")), MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5c7035a38c5ef32eL, 0x5c7035a38c5ef32fL, "ref"))) && !(isHidden)) {
      return _quotation_createNode_b65po9_a0a11a4(SNodeOperations.detachNode(SLinkOperations.getTarget(SNodeOperations.cast(lhs, MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a64eL, "jetbrains.mps.vclang.structure.ApplicationExpression")), MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b6aL, "rightArg"))), rhs, SLinkOperations.getTarget(SNodeOperations.cast(SLinkOperations.getTarget(SNodeOperations.cast(lhs, MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a64eL, "jetbrains.mps.vclang.structure.ApplicationExpression")), MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b68L, "leftArg")), MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x40feb6e2a72ce3afL, "jetbrains.mps.vclang.structure.DefExpression")), MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5c7035a38c5ef32eL, 0x5c7035a38c5ef32fL, "ref")));
    }


    return (isHidden ? lhs : _quotation_createNode_b65po9_a0o0e(lhs, (e.isExplicit() ? rhs : createImplicitArgument_b65po9_a0a0a0a41a4(SNodeOperations.cast(HUtil.copyIfNecessary(rhs), MetaAdapterFactory.getInterfaceConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940366eef7L, "jetbrains.mps.vclang.structure.AbstractExpression"))))));
  }
  public SNode visitDefCall(Abstract.DefCallExpression expression, Void context) {
    Abstract.Definition d = expression.getDefinitionPair().abstractDefinition;
    Definition d2 = expression.getDefinitionPair().definition;
    if (d == null && d2 != null) {
      DefinitionPair dp = d2.getNamespace().getParent().getMember(d2.getName().name);
      if (dp != null) {
        d = dp.abstractDefinition;
      }
    }
    if (d instanceof DefinitionAdapter) {
      DefinitionAdapter da = (DefinitionAdapter) d;
      return createDefExpression_b65po9_a1a3a5(da.getThisNode());
    } else if (d2 != null) {
      // This is only needed for correct operation of Prelude; 
      // TODO: Maybe refactor this? 
      return createDefExpression_b65po9_a2a0d0f(SNodeOperations.cast(AdapterUtils.getRaw(d2), MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0xfc408c778ec7ec8L, "jetbrains.mps.vclang.structure.Definition")));
    }
    return null;
  }
  public SNode visitIndex(Abstract.IndexExpression expression, Void context) {
    return createVariableExpression_b65po9_a0a6(ListSequence.fromList(indices).getElement(expression.getIndex()));
  }
  public SNode visitLam(final Abstract.LamExpression expression, final Void context) {
    List<Abstract.Argument> l = (List<Abstract.Argument>) expression.getArguments();
    return new BuildModelVisitor.ArgumentComputer<SNode>() {
      public SNode compute(List<SNode> args) {
        return _quotation_createNode_b65po9_a0a0a0a0b0h(args, expression.getBody().accept(BuildModelVisitor.this, context));
      }
    }.computeArgumentExpressionIndex(this, l, context);
  }
  public SNode visitPi(final Abstract.PiExpression expression, final Void context) {
    List<Abstract.Argument> l = (List<Abstract.Argument>) expression.getArguments();
    return new BuildModelVisitor.ArgumentComputer<SNode>() {
      public SNode compute(List<SNode> args) {
        SNode rhs = expression.getCodomain().accept(BuildModelVisitor.this, context);
        if (ListSequence.fromList(args).count() == 1 && SNodeOperations.isInstanceOf(ListSequence.fromList(args).getElement(0), MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5cf68b0abfa42c58L, "jetbrains.mps.vclang.structure.TypedArgument")) && !((SNodeOperations.isInstanceOf(ListSequence.fromList(args).getElement(0), MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a6c1L, "jetbrains.mps.vclang.structure.TelescopeArgument"))))) {
          return _quotation_createNode_b65po9_a0a1a0a0a0b0i(SLinkOperations.getTarget(SNodeOperations.cast(ListSequence.fromList(args).getElement(0), MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5cf68b0abfa42c58L, "jetbrains.mps.vclang.structure.TypedArgument")), MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5ace245L, 0x62a6e9940367a6bfL, "typeExpr")), rhs);
        } else {
          return _quotation_createNode_b65po9_a0a0b0a0a0a1a8(args, rhs);
        }
      }
    }.computeArgumentExpressionIndex(this, l, context);
  }
  public SNode visitUniverse(Abstract.UniverseExpression expression, Void context) {
    Universe u = expression.getUniverse();
    if (u instanceof Universe.Type) {
      Universe.Type t = (Universe.Type) u;
      if (t.getTruncated() == Universe.Type.PROP) {
        return _quotation_createNode_b65po9_a0a1a1a9();
      }
      if (t.getTruncated() == Universe.Type.SET) {
        return _quotation_createNode_b65po9_a0a2a1a9(String.valueOf(t.getLevel()));
      }
      return (t.getTruncated() == Universe.Type.NOT_TRUNCATED ? _quotation_createNode_b65po9_a0d0b0j_0(String.valueOf(t.getLevel())) : _quotation_createNode_b65po9_a0d0b0j(String.valueOf(t.getTruncated()), String.valueOf(t.getLevel())));
    }
    return null;
  }
  public SNode visitInferHole(Abstract.InferHoleExpression expression, Void context) {
    // TODO: 
    return null;
  }
  public SNode visitError(Abstract.ErrorExpression expression, Void context) {
    // TODO: 
    return null;
  }

  public SNode visitBinOpSequence(Abstract.BinOpSequenceExpression expression, Void context) {
    // TODO: Do nothing (this is related to the way how parser is implemented in Vclang 
    return null;
  }

  public SNode visitTuple(Abstract.TupleExpression expression, final Void context) {
    List<Abstract.Expression> exprs = (List<Abstract.Expression>) expression.getFields();
    return _quotation_createNode_b65po9_a1a51(ListSequence.fromList(exprs).select(new ISelector<Abstract.Expression, SNode>() {
      public SNode select(Abstract.Expression it) {
        return it.accept(BuildModelVisitor.this, context);
      }
    }).toListSequence());
  }
  public SNode visitSigma(Abstract.SigmaExpression expression, Void context) {
    List<Abstract.Argument> l = (List<Abstract.Argument>) expression.getArguments();
    return new BuildModelVisitor.ArgumentComputer<SNode>() {
      public SNode compute(List<SNode> args) {
        return _quotation_createNode_b65po9_a0a0a0a0b0q(args);
      }
    }.computeArgumentExpressionIndex(this, l, context);
  }
  public SNode visitBinOp(Abstract.BinOpExpression expression, Void context) {
    return _quotation_createNode_b65po9_a0a71(expression.getLeft().accept(this, context), expression.getRight().accept(this, context), AdapterUtils.getRaw(expression.getBinOp().definition));
  }

  public SNode visitElimCase(Abstract.ElimCaseExpression expression, final Void context) {
    List<SNode> exprNode = ListSequence.fromList(((List<Abstract.Expression>) expression.getExpressions())).select(new ISelector<Abstract.Expression, SNode>() {
      public SNode select(Abstract.Expression it) {
        return it.accept(BuildModelVisitor.this, context);
      }
    }).toListSequence();
    final List<SNode> matchedIndices = ListSequence.fromList(exprNode).where(new IWhereFilter<SNode>() {
      public boolean accept(SNode it) {
        return SNodeOperations.isInstanceOf(it, MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a651L, "jetbrains.mps.vclang.structure.VariableExpression"));
      }
    }).select(new ISelector<SNode, SNode>() {
      public SNode select(SNode it) {
        return SLinkOperations.getTarget(SNodeOperations.cast(it, MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a651L, "jetbrains.mps.vclang.structure.VariableExpression")), MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5c7035a38c5ef32eL, 0x5c7035a38c5ef32fL, "ref"));
      }
    }).toListSequence();
    List<Abstract.Clause> clauses = (List<Abstract.Clause>) expression.getClauses();
    SNode result = _quotation_createNode_b65po9_a0d0t(ListSequence.fromList(clauses).select(new ISelector<Abstract.Clause, SNode>() {
      public SNode select(Abstract.Clause it) {
        pushIndices();
        List<SNode> apat = new ArrayList<SNode>();
        List<Abstract.Pattern> l = (List<Abstract.Pattern>) it.getPatterns();
        {
          Iterator<Abstract.Pattern> pattern_it = ListSequence.fromList(l).iterator();
          Iterator<SNode> e_it = ListSequence.fromList(matchedIndices).iterator();
          Abstract.Pattern pattern_var;
          SNode e_var;
          while (pattern_it.hasNext() && e_it.hasNext()) {
            pattern_var = pattern_it.next();
            e_var = e_it.next();
            List<SNode> matchedVariables = new ArrayList<SNode>();
            ListSequence.fromList(apat).addElement(processPattern(BuildModelVisitor.this, pattern_var, matchedVariables));
            if (e_var != null) {
              int i = ListSequence.fromList(indices).indexOf(e_var);
              if (i != -1) {
                ListSequence.fromList(indices).removeElementAt(i);
                for (SNode v : ListSequence.fromList(matchedVariables).reversedList()) {
                  ListSequence.fromList(indices).insertElement(i, v);
                }
              }
            }
          }
        }
        SNode result = createClause_b65po9_a0e0a0a0a0a0a3a91(apat, SNodeOperations.cast(HUtil.copyIfNecessary(it.getExpression().accept(BuildModelVisitor.this, context)), MetaAdapterFactory.getInterfaceConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940366eef7L, "jetbrains.mps.vclang.structure.AbstractExpression")), Integer.parseInt(SEnumOperations.getEnumMemberValue(AdapterUtils.convertArrow2(it.getArrow()))));
        popIndices();
        return result;
      }
    }).toListSequence(), exprNode);
    return result;
  }

  public SNode visitElim(Abstract.ElimExpression expression, Void context) {
    return visitElimCase(expression, context);
  }
  public SNode visitCase(Abstract.CaseExpression expression, Void context) {
    return visitElimCase(expression, context);
  }
  public SNode visitProj(Abstract.ProjExpression expression, Void context) {
    // TODO: Implement Proj expression 
    return null;
  }
  public SNode visitClassExt(Abstract.ClassExtExpression expression, Void context) {
    // TODO: Implement class extensions 
    return null;
  }
  public SNode visitNew(Abstract.NewExpression expression, Void context) {
    return _quotation_createNode_b65po9_a0a52(expression.getExpression().accept(this, context));
  }
  public SNode visitLet(Abstract.LetExpression expression, final Void context) {
    List<SNode> clauses = new ArrayList<SNode>();
    int count = 0;
    for (Abstract.LetClause clause : ListSequence.fromList(expression.getClauses())) {
      final Abstract.LetClause finalClause = clause;
      List<Abstract.Argument> l = (List<Abstract.Argument>) clause.getArguments();
      SNode c = new BuildModelVisitor.ArgumentComputer<SNode>() {
        public SNode compute(List<SNode> args) {
          return createLetClause_b65po9_a0a0a0a0a2a2a62(finalClause.getName().name, Integer.parseInt(SEnumOperations.getEnumMemberValue(AdapterUtils.convertArrow2(finalClause.getArrow()))), args, SNodeOperations.cast(HUtil.copyIfNecessary(finalClause.getTerm().accept(BuildModelVisitor.this, context)), MetaAdapterFactory.getInterfaceConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940366eef7L, "jetbrains.mps.vclang.structure.AbstractExpression")), SNodeOperations.cast(HUtil.copyIfNecessary(finalClause.getResultType().accept(BuildModelVisitor.this, context)), MetaAdapterFactory.getInterfaceConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940366eef7L, "jetbrains.mps.vclang.structure.AbstractExpression")));
        }
      }.computeArgumentExpressionIndex(this, l, context);
      ListSequence.fromList(clauses).addElement(c);
      ListSequence.fromList(indices).insertElement(0, c);
      count++;
    }
    SNode result = _quotation_createNode_b65po9_a0d0ab(clauses, expression.getExpression().accept(this, context));
    releaseVariables(count);
    return result;
  }

  public static SNode processPattern(final BuildModelVisitor visitor, Abstract.Pattern p2, final List<SNode> matchedVariables) {
    SNode result = null;
    if (p2 instanceof NamePattern) {
      NamePattern np = (NamePattern) p2;
      String name = np.getName();
      if (name != null) {
        result = _quotation_createNode_b65po9_a0a0c0b0cb(name);
        ListSequence.fromList(matchedVariables).addElement(SNodeOperations.cast(result, MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x134a75c1410d5ad1L, "jetbrains.mps.vclang.structure.PatternId")));
      } else {
        result = _quotation_createNode_b65po9_a0a0a2a1a82();
        ListSequence.fromList(matchedVariables).addElement(null);
      }
    } else if (p2 instanceof Abstract.ConstructorPattern) {
      Abstract.ConstructorPattern cp = (Abstract.ConstructorPattern) p2;
      List<Abstract.Pattern> cargs = (List<Abstract.Pattern>) cp.getPatterns();
      SNode cons = null;
      if (cp instanceof ConstructorPattern) {
        cons = SNodeOperations.cast(AdapterUtils.getRaw(((ConstructorPattern) cp).getConstructor()), MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x75cfba109e2ee29aL, "jetbrains.mps.vclang.structure.Constructor"));
      }
      result = _quotation_createNode_b65po9_a0e0a1a82(ListSequence.fromList(cargs).select(new ISelector<Abstract.Pattern, SNode>() {
        public SNode select(Abstract.Pattern it) {
          return processPattern(visitor, it, matchedVariables);
        }
      }).toListSequence(), cons);
    }
    return result;
  }


  public abstract class ArgumentComputer<T> {
    public abstract T compute(List<SNode> args);

    public T computeArgumentExpressionIndex(BuildModelVisitor visitor, List<Abstract.Argument> args, Void context) {
      List<SNode> vars = new ArrayList<SNode>();
      int counter = 0;
      for (Abstract.Argument arg : ListSequence.fromList(args)) {
        if (arg instanceof Abstract.TypeArgument) {
          SNode h = ((Abstract.TypeArgument) arg).getType().accept(BuildModelVisitor.this, context);
          if (arg instanceof Abstract.TelescopeArgument) {
            Abstract.TelescopeArgument t = (Abstract.TelescopeArgument) arg;
            List<SNode> teleArgs = new ArrayList<SNode>();
            for (String n : t.getNames()) {
              counter++;
              ListSequence.fromList(teleArgs).addElement(visitor.addIndex(n));
            }
            ListSequence.fromList(vars).addElement(_quotation_createNode_b65po9_a0a3a1a0a2a2fb(h, teleArgs));
          } else {
            Abstract.TypeArgument t = (Abstract.TypeArgument) arg;
            counter++;
            ListSequence.fromList(visitor.indices).insertElement(0, null);
            ListSequence.fromList(vars).addElement(_quotation_createNode_b65po9_a0a3a0b0a0c0c13(h));
          }
        } else if (arg instanceof Abstract.NameArgument) {
          Abstract.NameArgument t = (Abstract.NameArgument) arg;
          counter++;
          ListSequence.fromList(vars).addElement(visitor.addIndex(t.getName()));
        }
      }
      T result = compute(vars);
      visitor.releaseVariables(counter);
      return result;
    }
  }


  public SNode addIndex(String name) {
    SNode result = _quotation_createNode_b65po9_a0a0ib(name);
    ListSequence.fromList(indices).insertElement(0, result);
    return result;
  }

  public void releaseVariables(int count) {
    indices = ListSequence.fromList(indices).subListSequence(count, ListSequence.fromList(indices).count());
  }

  public void pushIndices() {
    List<SNode> l = new ArrayList<SNode>();
    ListSequence.fromList(l).addSequence(ListSequence.fromList(indices));
    DequeSequence.fromDequeNew(indexStack).pushElement(l);
  }

  public void popIndices() {
    indices = DequeSequence.fromDequeNew(indexStack).popElement();
  }


  private static SNode _quotation_createNode_b65po9_a0a0a3a4(Object parameter_1, Object parameter_2, Object parameter_3) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    SNode quotedNode_6 = null;
    SNode quotedNode_7 = null;
    SNode quotedNode_8 = null;
    quotedNode_4 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x75cfba109e316d2cL, "jetbrains.mps.vclang.structure.BinOpExpression"), null, null, false);
    SNodeAccessUtil.setReferenceTarget(quotedNode_4, MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x75cfba109e316d2cL, 0x75cfba109e316d2dL, "function"), (SNode) parameter_3);
    quotedNode_5 = (SNode) parameter_1;
    if (quotedNode_5 != null) {
      quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b68L, "leftArg"), HUtil.copyIfNecessary(quotedNode_5));
    }
    quotedNode_6 = (SNode) parameter_2;
    if (quotedNode_6 != null) {
      quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b6aL, "rightArg"), HUtil.copyIfNecessary(quotedNode_6));
    }
    return quotedNode_4;
  }
  private static SNode _quotation_createNode_b65po9_a0a11a4(Object parameter_1, Object parameter_2, Object parameter_3) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    SNode quotedNode_6 = null;
    SNode quotedNode_7 = null;
    SNode quotedNode_8 = null;
    quotedNode_4 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x75cfba109e316d2cL, "jetbrains.mps.vclang.structure.BinOpExpression"), null, null, false);
    SNodeAccessUtil.setReferenceTarget(quotedNode_4, MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x75cfba109e316d2cL, 0x75cfba109e316d2dL, "function"), (SNode) parameter_3);
    quotedNode_5 = (SNode) parameter_1;
    if (quotedNode_5 != null) {
      quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b68L, "leftArg"), HUtil.copyIfNecessary(quotedNode_5));
    }
    quotedNode_6 = (SNode) parameter_2;
    if (quotedNode_6 != null) {
      quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b6aL, "rightArg"), HUtil.copyIfNecessary(quotedNode_6));
    }
    return quotedNode_4;
  }
  private static SNode _quotation_createNode_b65po9_a0o0e(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a64eL, "jetbrains.mps.vclang.structure.ApplicationExpression"), null, null, false);
    quotedNode_4 = (SNode) parameter_1;
    if (quotedNode_4 != null) {
      quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b68L, "leftArg"), HUtil.copyIfNecessary(quotedNode_4));
    }
    quotedNode_5 = (SNode) parameter_2;
    if (quotedNode_5 != null) {
      quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b6aL, "rightArg"), HUtil.copyIfNecessary(quotedNode_5));
    }
    return quotedNode_3;
  }
  private static SNode createImplicitArgument_b65po9_a0a0a0a41a4(Object p0) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode n1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5cf68b0abfab6115L, "jetbrains.mps.vclang.structure.ImplicitArgument"), null, null, false);
    if (p0 != null) {
      n1.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x61f824a8086fa9f4L, 0x61f824a8086fa9fcL, "expression"), (SNode) p0);
    }
    return n1;
  }
  private static SNode createDefExpression_b65po9_a1a3a5(Object p0) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode n1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x40feb6e2a72ce3afL, "jetbrains.mps.vclang.structure.DefExpression"), null, null, false);
    n1.setReferenceTarget(MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5c7035a38c5ef32eL, 0x5c7035a38c5ef32fL, "ref"), (SNode) p0);
    return n1;
  }
  private static SNode createDefExpression_b65po9_a2a0d0f(Object p0) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode n1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x40feb6e2a72ce3afL, "jetbrains.mps.vclang.structure.DefExpression"), null, null, false);
    n1.setReferenceTarget(MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5c7035a38c5ef32eL, 0x5c7035a38c5ef32fL, "ref"), (SNode) p0);
    return n1;
  }
  private static SNode createVariableExpression_b65po9_a0a6(Object p0) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode n1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a651L, "jetbrains.mps.vclang.structure.VariableExpression"), null, null, false);
    n1.setReferenceTarget(MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5c7035a38c5ef32eL, 0x5c7035a38c5ef32fL, "ref"), (SNode) p0);
    return n1;
  }
  private static SNode _quotation_createNode_b65po9_a0a0a0a0b0h(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    SNode quotedNode_6 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x75cfba109e31841fL, "jetbrains.mps.vclang.structure.BracketExpression"), null, null, false);
    quotedNode_4 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a284L, "jetbrains.mps.vclang.structure.LambdaExpression"), null, null, false);
    {
      List<SNode> nodes = (List<SNode>) parameter_1;
      for (SNode child : nodes) {
        quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0xc23f5510097501bL, 0xc23f5510097501cL, "args"), HUtil.copyIfNecessary(child));
      }
    }
    quotedNode_6 = (SNode) parameter_2;
    if (quotedNode_6 != null) {
      quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a284L, 0x634b3353f5ace157L, "body"), HUtil.copyIfNecessary(quotedNode_6));
    }
    quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x61f824a8086fa9f4L, 0x61f824a8086fa9fcL, "expression"), quotedNode_4);
    return quotedNode_3;
  }
  private static SNode _quotation_createNode_b65po9_a0a1a0a0a0b0i(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    SNode quotedNode_6 = null;
    SNode quotedNode_7 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0f5fL, "jetbrains.mps.vclang.structure.ArrowExpression"), null, null, false);
    quotedNode_4 = (SNode) parameter_1;
    if (quotedNode_4 != null) {
      quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b68L, "leftArg"), HUtil.copyIfNecessary(quotedNode_4));
    }
    quotedNode_5 = (SNode) parameter_2;
    if (quotedNode_5 != null) {
      quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b6aL, "rightArg"), HUtil.copyIfNecessary(quotedNode_5));
    }
    return quotedNode_3;
  }
  private static SNode _quotation_createNode_b65po9_a0a0b0a0a0a1a8(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a264L, "jetbrains.mps.vclang.structure.PiExpression"), null, null, false);
    {
      List<SNode> nodes = (List<SNode>) parameter_1;
      for (SNode child : nodes) {
        quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0xc23f5510097501bL, 0xc23f5510097501cL, "args"), HUtil.copyIfNecessary(child));
      }
    }
    quotedNode_5 = (SNode) parameter_2;
    if (quotedNode_5 != null) {
      quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a264L, 0x62a6e9940367d382L, "codomain"), HUtil.copyIfNecessary(quotedNode_5));
    }
    return quotedNode_3;
  }
  private static SNode _quotation_createNode_b65po9_a0a1a1a9() {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_1 = null;
    quotedNode_1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af1159L, "jetbrains.mps.vclang.structure.PropUniverse"), null, null, false);
    return quotedNode_1;
  }
  private static SNode _quotation_createNode_b65po9_a0a2a1a9(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af115aL, "jetbrains.mps.vclang.structure.SetUniverse"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0fa6L, 0x634b3353f5af0fa7L, "level"), (String) parameter_1);
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_b65po9_a0d0b0j(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0ff1L, "jetbrains.mps.vclang.structure.TruncatedTypeUniverse"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_3, MetaAdapterFactory.getProperty(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0fa6L, 0x634b3353f5af0fa7L, "level"), (String) parameter_2);
    SNodeAccessUtil.setProperty(quotedNode_3, MetaAdapterFactory.getProperty(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0ff1L, 0x634b3353f5af0ff2L, "truncLevel"), (String) parameter_1);
    return quotedNode_3;
  }
  private static SNode _quotation_createNode_b65po9_a0d0b0j_0(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0fa9L, "jetbrains.mps.vclang.structure.TypeUniverse"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0fa6L, 0x634b3353f5af0fa7L, "level"), (String) parameter_1);
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_b65po9_a1a51(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    SNode quotedNode_3 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a654L, "jetbrains.mps.vclang.structure.TupleExpression"), null, null, false);
    {
      List<SNode> nodes = (List<SNode>) parameter_1;
      for (SNode child : nodes) {
        quotedNode_2.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a654L, 0x75cfba109e317433L, "fields"), HUtil.copyIfNecessary(child));
      }
    }
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_b65po9_a0a0a0a0b0q(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    SNode quotedNode_3 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a26dL, "jetbrains.mps.vclang.structure.SigmaExpression"), null, null, false);
    {
      List<SNode> nodes = (List<SNode>) parameter_1;
      for (SNode child : nodes) {
        quotedNode_2.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0xc23f5510097501bL, 0xc23f5510097501cL, "args"), HUtil.copyIfNecessary(child));
      }
    }
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_b65po9_a0a71(Object parameter_1, Object parameter_2, Object parameter_3) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    SNode quotedNode_6 = null;
    quotedNode_4 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x75cfba109e316d2cL, "jetbrains.mps.vclang.structure.BinOpExpression"), null, null, false);
    SNodeAccessUtil.setReferenceTarget(quotedNode_4, MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x75cfba109e316d2cL, 0x75cfba109e316d2dL, "function"), (SNode) parameter_3);
    quotedNode_5 = (SNode) parameter_1;
    if (quotedNode_5 != null) {
      quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b68L, "leftArg"), HUtil.copyIfNecessary(quotedNode_5));
    }
    quotedNode_6 = (SNode) parameter_2;
    if (quotedNode_6 != null) {
      quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a261L, 0x75cfba109e316b6aL, "rightArg"), HUtil.copyIfNecessary(quotedNode_6));
    }
    return quotedNode_4;
  }
  private static SNode _quotation_createNode_b65po9_a0d0t(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    SNode quotedNode_6 = null;
    SNode quotedNode_7 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940366eec3L, "jetbrains.mps.vclang.structure.ElimExpression"), null, null, false);
    {
      List<SNode> nodes = (List<SNode>) parameter_1;
      for (SNode child : nodes) {
        quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940366eec3L, 0x634b3353f5aea13dL, "clauses"), HUtil.copyIfNecessary(child));
      }
    }
    {
      List<SNode> nodes = (List<SNode>) parameter_2;
      for (SNode child : nodes) {
        quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940366eec3L, 0x634b3353f5af09c8L, "expression"), HUtil.copyIfNecessary(child));
      }
    }
    return quotedNode_3;
  }
  private static SNode createClause_b65po9_a0e0a0a0a0a0a3a91(Object p0, Object p1, Object p2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode n1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0aceL, "jetbrains.mps.vclang.structure.Clause"), null, null, false);
    for (SNode n : (Iterable<SNode>) p0) {
      n1.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0aceL, 0x5dac490c31280286L, "patterns"), n);
    }
    if (p1 != null) {
      n1.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0aceL, 0x634b3353f5af0b47L, "clauseExpression"), (SNode) p1);
    }
    n1.setProperty(MetaAdapterFactory.getProperty(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5af0aceL, 0x634b3353f5af0b0aL, "arrow"), p2 + "");
    return n1;
  }
  private static SNode _quotation_createNode_b65po9_a0a52(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    SNode quotedNode_3 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x134a75c14102d4e1L, "jetbrains.mps.vclang.structure.NewExpression"), null, null, false);
    quotedNode_3 = (SNode) parameter_1;
    if (quotedNode_3 != null) {
      quotedNode_2.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x134a75c14102d4e1L, 0x134a75c14107d357L, "expr"), HUtil.copyIfNecessary(quotedNode_3));
    }
    return quotedNode_2;
  }
  private static SNode createLetClause_b65po9_a0a0a0a0a2a2a62(Object p0, Object p1, Object p2, Object p3, Object p4) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode n1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x4e9ce656c7c3f7ceL, "jetbrains.mps.vclang.structure.LetClause"), null, null, false);
    n1.setProperty(MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name"), p0 + "");
    n1.setProperty(MetaAdapterFactory.getProperty(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x4e9ce656c7c3f7ceL, 0x4e9ce656c7c6f05cL, "arrow"), p1 + "");
    for (SNode n : (Iterable<SNode>) p2) {
      n1.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0xc23f5510097501bL, 0xc23f5510097501cL, "args"), n);
    }
    if (p3 != null) {
      n1.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x4e9ce656c7c3f7ceL, 0x4e9ce656c7c6f05eL, "expression"), (SNode) p3);
    }
    if (p4 != null) {
      n1.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x52895c158533aed8L, 0x52895c158533aeddL, "type"), (SNode) p4);
    }
    return n1;
  }
  private static SNode _quotation_createNode_b65po9_a0d0ab(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    SNode quotedNode_6 = null;
    SNode quotedNode_7 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x4e9ce656c7c3f7ccL, "jetbrains.mps.vclang.structure.LetExpression"), null, null, false);
    {
      List<SNode> nodes = (List<SNode>) parameter_1;
      for (SNode child : nodes) {
        quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x4e9ce656c7c3f7ccL, 0x4e9ce656c7c3f7cfL, "clauses"), HUtil.copyIfNecessary(child));
      }
    }
    quotedNode_5 = (SNode) parameter_2;
    if (quotedNode_5 != null) {
      quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x4e9ce656c7c3f7ccL, 0x4e9ce656c7c3f7d1L, "expression"), HUtil.copyIfNecessary(quotedNode_5));
    }
    return quotedNode_3;
  }
  private static SNode _quotation_createNode_b65po9_a0a0c0b0cb(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x134a75c1410d5ad1L, "jetbrains.mps.vclang.structure.PatternId"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name"), (String) parameter_1);
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_b65po9_a0a0a2a1a82() {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_1 = null;
    quotedNode_1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x134a75c1410d5ad0L, "jetbrains.mps.vclang.structure.PatternAny"), null, null, false);
    return quotedNode_1;
  }
  private static SNode _quotation_createNode_b65po9_a0e0a1a82(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x134a75c1410d5ad4L, "jetbrains.mps.vclang.structure.PatternConstructor"), null, null, false);
    SNodeAccessUtil.setReferenceTarget(quotedNode_3, MetaAdapterFactory.getReferenceLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x1e1ef882fa2fd10dL, 0x134a75c1410d5ad5L, "constructor"), (SNode) parameter_2);
    {
      List<SNode> nodes = (List<SNode>) parameter_1;
      for (SNode child : nodes) {
        quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x1e1ef882fa2fd10dL, 0x134a75c1410d5afaL, "argPatterns"), HUtil.copyIfNecessary(child));
      }
    }
    return quotedNode_3;
  }
  private static SNode _quotation_createNode_b65po9_a0a3a1a0a2a2fb(Object parameter_1, Object parameter_2) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a6c1L, "jetbrains.mps.vclang.structure.TelescopeArgument"), null, null, false);
    quotedNode_4 = (SNode) parameter_1;
    if (quotedNode_4 != null) {
      quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5ace245L, 0x62a6e9940367a6bfL, "typeExpr"), HUtil.copyIfNecessary(quotedNode_4));
    }
    {
      List<SNode> nodes = (List<SNode>) parameter_2;
      for (SNode child : nodes) {
        quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a6c1L, 0x62a6e9940367a6e2L, "varNames"), HUtil.copyIfNecessary(child));
      }
    }
    return quotedNode_3;
  }
  private static SNode _quotation_createNode_b65po9_a0a3a0b0a0c0c13(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    SNode quotedNode_3 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x5cf68b0abfa42c58L, "jetbrains.mps.vclang.structure.TypedArgument"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5ace245L, 0xc23f551009d041dL, "isImplicit"), "false");
    quotedNode_3 = (SNode) parameter_1;
    if (quotedNode_3 != null) {
      quotedNode_2.addChild(MetaAdapterFactory.getContainmentLink(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x634b3353f5ace245L, 0x62a6e9940367a6bfL, "typeExpr"), HUtil.copyIfNecessary(quotedNode_3));
    }
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_b65po9_a0a0ib(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x2db233bb72db49c3L, 0xadc47ae97f87f8dcL, 0x62a6e9940367a6e4L, "jetbrains.mps.vclang.structure.Variable"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name"), (String) parameter_1);
    return quotedNode_2;
  }
}
